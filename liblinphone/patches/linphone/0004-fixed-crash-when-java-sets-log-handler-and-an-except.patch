From 8cffd2ac1a8c36acae0d7a0f2204e9b8cee27f20 Mon Sep 17 00:00:00 2001
From: Ben Sartor <ben@simlar.org>
Date: Wed, 13 May 2015 22:39:25 +0200
Subject: [PATCH 4/5] fixed crash when java sets log handler and an exception
 is thrown

---
 coreapi/linphonecore_jni.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/coreapi/linphonecore_jni.cc b/coreapi/linphonecore_jni.cc
index 0558a5f..13244f5 100644
--- a/coreapi/linphonecore_jni.cc
+++ b/coreapi/linphonecore_jni.cc
@@ -1115,8 +1115,8 @@ private:
 	static inline void handle_possible_java_exception(JNIEnv *env, jobject listener)
 	{
 		if (env->ExceptionCheck()) {
-			ms_error("Listener %p raised an exception",listener);
 			env->ExceptionClear();
+			ms_error("Listener %p raised an exception",listener);
 		}
 	}
 };
-- 
2.1.4

